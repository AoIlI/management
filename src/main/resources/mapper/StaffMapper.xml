<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="org.example.demo.mapper.StaffMapper">

    <select id="selectMaxStaffId" resultType="string">
        SELECT MAX(staff_id) FROM staff
    </select>

    <select id="selectAll" resultType="org.example.demo.entity.Staff">
        SELECT staff_id AS staffId, account_id AS accountId, name, role, phone, email, 
               specialty, hire_date AS hireDate, status, department
        FROM staff
    </select>

    <select id="selectByStaffId" resultType="org.example.demo.entity.Staff">
        SELECT staff_id AS staffId, account_id AS accountId, name, role, phone, email, 
               specialty, hire_date AS hireDate, status, department
        FROM staff
        WHERE staff_id = #{staffId}
    </select>

    <select id="selectByAccountId" resultType="org.example.demo.entity.Staff">
        SELECT staff_id AS staffId, account_id AS accountId, name, role, phone, email, 
               specialty, hire_date AS hireDate, status, department
        FROM staff
        WHERE account_id = #{accountId}
    </select>

    <select id="searchStaffs" resultType="org.example.demo.entity.Staff">
        SELECT staff_id AS staffId, account_id AS accountId, name, role, phone, email, 
               specialty, hire_date AS hireDate, status, department
        FROM staff
        WHERE (name LIKE CONCAT('%', #{keyword}, '%')
            OR phone LIKE CONCAT('%', #{keyword}, '%'))
    </select>

    <insert id="insert" parameterType="org.example.demo.entity.Staff">
        INSERT INTO staff
        (staff_id, account_id, name, role, phone, email, specialty, hire_date, status, department)
        VALUES
            (#{staffId}, #{accountId}, #{name}, #{role}, #{phone}, #{email}, 
             #{specialty}, #{hireDate}, #{status}, #{department})
    </insert>

    <update id="updateStaff" parameterType="org.example.demo.entity.Staff">
        UPDATE staff
        SET name = #{name},
            role = #{role},
            phone = #{phone},
            email = #{email},
            specialty = #{specialty},
            hire_date = #{hireDate},
            status = #{status},
            department = #{department}
        WHERE staff_id = #{staffId}
    </update>

    <delete id="deleteById" parameterType="String">
        DELETE FROM staff
        WHERE staff_id = #{staffId}
    </delete>

</mapper>

